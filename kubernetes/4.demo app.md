![screenshot](./pictures/229155000.png)
![screenshot](./pictures/374729000.png)

åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶:

`mongo-deployment.yaml`

```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mongodb-deployment
  labels:
    app: mongodb
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mongodb
  template:
    metadata:
      labels:
        app: mongodb
    spec:
      containers:
      - name: mongodb
        image: mongo
        ports:
        - containerPort: 27017
        env:
        - name: MONGO_INITDB_ROOT_USERNAME
          valueFrom:
            secretKeyRef:
              name: mongodb-secret
              key: mongo-root-username
        - name: MONGO_INITDB_ROOT_PASSWORD
          valueFrom:
            secretKeyRef:
              name:  mongodb-secret
              key: mongo-root-password
```

`mongo-secret`
ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å°†ä¼šåˆ›å»º`KubernetesRocks!`çš„base64åŠ å¯†åçš„å¯†ç ã€‚
```
echo -n 'KubernetesRocks!' | base64
```
ä¸‹é¢çš„ç”¨æˆ·åè·Ÿå¯†ç æ˜¯Base64åŠ å¯†åçš„`username`ä»¥åŠ`password`å­—æ®µ

```
apiVersion: v1
kind: Secret
metadata:
  name: mongodb-secret
type: Opaque
data:
  mongo-root-username: dXNlcm5hbWU=
  mongo-root-password: cGFzc3dvcmQ=

```

ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥ç¡®è®¤ secret:

```
kubectl apply -f mongo-secret.yaml
```

![screenshot](./pictures/885981000.png)

åˆ›å»ºè¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥ debug:

é¦–å…ˆæŸ¥çœ‹ç°åœ¨çš„`pod`:

```
kubectl get pod
```

å°†ä¼šçœ‹åˆ° pod çš„`NAME`å±æ€§
![screenshot](./pictures/676886000.png)

å€¼å¾—æ³¨æ„çš„æ˜¯åé¢çš„éƒ¨åˆ†å¯ä»¥çœç•¥ ğŸ‘‡ğŸ»

```
kubectl describe pod mongodb-deployment-*****
```

ç„¶åå°† service çš„å®šä¹‰å†™åœ¨ mongo-deployment.yml é‡Œ

![screenshot](./pictures/942619000.png)

ç„¶åé‡æ–°åŠ è½½ `mongo-deployment.yaml`æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå‡ºç°è¿™æ ·çš„æç¤º:

```
deployment.apps/mongodb-deployment unchanged
service/mongodb-service created
```

![screenshot](./pictures/217760000.png)

![screenshot](./pictures/243283000.png)
![screenshot](./pictures/311902000.png)
é€šè¿‡å®šä¹‰ä¸€ä¸ª configMap æ–‡ä»¶æˆ‘ä»¬å¯ä»¥å­˜æ”¾ä¸€äº›ç¯å¢ƒå˜é‡:

```
apiVersion: v1
kind: ConfigMap
metadata:
  name: mongodb-configmap
data:
  database_url: mongodb-service
```

data é‡Œé¢çš„`database_url`å°±æ˜¯ configMap çš„ä¸€ä¸ªé”®ã€‚
ç„¶ååœ¨å®šä¹‰`mongo-express.yaml`çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨`valueFrom`çš„æ–¹å¼å¯¼å…¥`configMap`çš„é…ç½®äº†
![screenshot](./pictures/547743000.png)

ç„¶åä½¿ç”¨å‘½ä»¤`kubectl load - f`å°† yaml é…ç½®æ–‡ä»¶åŠ è½½åˆ°ç³»ç»Ÿä¸­ã€‚

æŸ¥çœ‹æŸä¸€ä¸ª pod çš„è¿è¡Œæƒ…å†µä½¿ç”¨å‘½ä»¤:

```
kubectl logs [podçš„NAME]
```
![screenshot](./pictures/114330000.png)

å¯åŠ¨mongo-expressä¹‹åï¼Œç”±äºéœ€è¦æä¾›ç»™å‰ç«¯è®¿é—®çš„æ¥å£ï¼Œå› æ­¤è¿˜éœ€è¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡,è€Œä¸”æ˜¯ç»™å¤–éƒ¨è®¿é—®çš„æœåŠ¡ã€‚åŒæ ·æ˜¯åœ¨`mongo-express.yaml`æ–‡ä»¶ä¸‹æ·»åŠ serviceçš„å®šä¹‰ã€‚

nodePortå°±æ˜¯å¼€æ”¾ç»™å¤–éƒ¨æµè§ˆå™¨è®¿é—®çš„ç«¯å£ï¼Œè¿™é‡Œç«¯å£å·ä¸º`30000`

![screenshot](./pictures/481730000.png)

![screenshot](./pictures/671434000.png)

æœåŠ¡ç¼ºå°‘å¤–éƒ¨IP,minikubeçš„åŠæ³•æ˜¯:

```
minikube service mongo-express-service
```
